---
# Source: datree-admission-webhook/templates/clusterrole.yaml

apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: datree-webhook-server-read
  labels: 
    app.kubernetes.io/name: datree-admission-webhook
    app.kubernetes.io/managed-by: "Helm"
    app.kubernetes.io/instance: "datree-webhook"
    app.kubernetes.io/version: 0.1.30
    app.kubernetes.io/part-of: "datree"
    meta.helm.sh/release-name: "datree-admission-webhook"
    meta.helm.sh/release-namespace: "datree" 
    helm.sh/chart: datree-admission-webhook-0.3.10
rules:
  - apiGroups:
      - ""
    resources:
      - "nodes"
      - "namespaces"
    verbs:
      - "get"
      - "list"
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: datree-namespaces-update
  labels: 
    app.kubernetes.io/name: datree-admission-webhook
    app.kubernetes.io/managed-by: "Helm"
    app.kubernetes.io/instance: "datree-webhook"
    app.kubernetes.io/version: 0.1.30
    app.kubernetes.io/part-of: "datree"
    meta.helm.sh/release-name: "datree-admission-webhook"
    meta.helm.sh/release-namespace: "datree" 
    helm.sh/chart: datree-admission-webhook-0.3.10
rules:
  - apiGroups:
      - ""
    resources:
      - namespaces
    verbs:
      - get
      - update
      - patch
    resourceNames:
      - kube-system
      - datree
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: datree-validationwebhook-delete
  labels: 
    app.kubernetes.io/name: datree-admission-webhook
    app.kubernetes.io/managed-by: "Helm"
    app.kubernetes.io/instance: "datree-webhook"
    app.kubernetes.io/version: 0.1.30
    app.kubernetes.io/part-of: "datree"
    meta.helm.sh/release-name: "datree-admission-webhook"
    meta.helm.sh/release-namespace: "datree" 
    helm.sh/chart: datree-admission-webhook-0.3.10
rules:
  - apiGroups:
      - "admissionregistration.k8s.io"
    resources:
      - validatingwebhookconfigurations
    verbs:
      - create
      - delete
      - get
      - list
      - patch
      - update
      - watch
    resourceNames:
      - datree-webhook
---
# Source: datree-admission-webhook/templates/webhook-with-cert-secrets.yaml
apiVersion: v1
kind: Secret
metadata:
  name: datree-ca-tls
  labels: 
    app.kubernetes.io/name: datree-admission-webhook
    app.kubernetes.io/managed-by: "Helm"
    app.kubernetes.io/instance: "datree-webhook"
    app.kubernetes.io/version: 0.1.30
    app.kubernetes.io/part-of: "datree"
    meta.helm.sh/release-name: "datree-admission-webhook"
    meta.helm.sh/release-namespace: "datree" 
    helm.sh/chart: datree-admission-webhook-0.3.10
  namespace: datree
type: kubernetes.io/tls
data:
  tls.key: LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFcFFJQkFBS0NBUUVBMllIVXJDa3pieFpzS1JxcDJXTmdPWHRaNWJXdXV1ZlBnRVJOam9sSzlnZU5uWUJaCjk0NW44b0F2NUVRcFRIT0podUtiQ0owa012a3Q3NEFlUlpNbVZMT2x1a0VYb1VWaGs3MWQxczJsdHg0UDF2ZksKdC9sUlp5Rzc2YzhHZXRQYitWemZWS2pLT1ZvdDNKVG5ZOFFBa1pxRnRtZ3p3U1R0eXMyVy9uVkduM2dsWFVCSQpaanZRZmFKTXg1SXBuS3VGOHFuWjBCUnBOeXYvcGRlK1ZCeG02RlFHbGoxTkZNMmw1QXZkUEtYK2x6SWVuN1RYCjNXNlBWRjU3VVk2clJZVkdzYTEvdGlocDNZdEZUSHRZbnBHT3FRVTBNR29nZy9YWEdrTGVOTFkzdmovRUJXS2cKWGJaekx0SndTRVpLcUVyQWQyRHhrc1FzaUdvQjBlcHZ1STUzbFFJREFRQUJBb0lCQVFDOS9aaGxvYitadzM1TApFVTFYNUdSREVhcGU2cXByL056Vjc5UEhNOG5VeXBnN0FjaVVZMElOSTBleUhvL3NoZWVWZVE5dklNUmoraURUCjJaZVhzb2VDNlVGVVJsTjd2WDBVYmc4ditJWk9RK1lXSW5CaTcxYlp2Uy9GZGQ3MUgyWkFsWTFIQ0FGTXc2YlgKelFHcHRhWEJpYlpPdFFxd0phL0l2SGl1WUlhRjkvSFhsZFFyOXYzNDdsd01kZm5hNGFYVW5PU3IxRkdxd21CNgpPWGpLRzVGaEtkbUhZNHl6Y2hrWmFyamR2eERDNXpvdElkSWxUYU55M2JkZ3lsRE8xTjhhdzdXNlZ0T3hHdk9SCi8zUkltck1PZDZRY2YrMTdsQjZJZktWNHVDYlBNcmYvYXh1Nk5tUjRKWGVjZkZKN0VGOTFjcXpWQTBDQ1dZczgKMGRpcUhNMHBBb0dCQU44YS80SlF5MWcxT2hLOFVEUVBjMGs3SkxJRE5wTHNvRU94OTFIVkgvc3dhVG5Qb3dpZQpzdk5DUXg2MzdKeG0rVFpGNURlTU9YYWhka1VuZWRMMmJFSi8zd0xmV3IzbDF5VWo1Z3NOWGNHR3RTdERLUnJQCktrNlJ0TENmNE84K0tQSGE2dll6RWFra0VLV2FqS2dEWmppb2tNc2FMOWp6UittYVhxb2RvNVByQW9HQkFQbVQKaHY0NXFtclplWm1yQTBDZEZGRENScitaNGRRS25XMjFoMzJTWGFKRGhDOFhEb1R1NHpMZkE3eVRWclp3aSt0dgpVeTdWSVZoWFVSaFg0bUJuQ3Jjblg5bVdMbnJiY0NyTUp4OVR3em44QjZHN1g3b0VQcjlpSlNzZG4wWDdLS0c3CitxSW42bERTMG9ralpBd1lUT2NvdStpNVdiWHB3REp1QnZDbThNSi9Bb0dBZXJDV0lrdmNCejMrR1orRlc1dkQKZ2xvTDYvam9ZaFBPYm12SDNqQ2R6Ynpwb09rV2R2OE8yY2R1c2MzalNIODRQU2hpUUVuVXIvQks0ZXk3aWRBSgo2T2Y0ODlOd1MwM0I2cUs3TndpNnJsb3Q5d1NQN2paT3hiWks3M1o4ZEJSeTM4M0x1R2lOSmI2M2lOcGN6MmhQCkpvbE1WdVNudTE3T0JTRG5QaFhlaHRFQ2dZRUFoZ3cyOVZVRHMyQWJiKzNxVVVvTkgxTTVySzk2RyttWHBOVmIKY0phc3MvcVBoTHRka1FpOS94VEpiUCsyRTBkZjM1UnJtVHZnTFJLNCs5bzRQSThic2tQenQycHlqSXBRTkt4eQpWdUVtZW41am12cUk3K0JYMDNOamcwVGx4ekNmSWo5VTNzT1JsdGVsUFFORk9UblVGRlJNbVRMMGZFQ1Flb1dlCk5LTjFyUUVDZ1lFQXJqWGFtVGdabHlSeW9pS1Z1UmREVjF1ZzJtSkQzd091SGdzRHpqTGVFSkFjRkV1akswTzMKVkx2cHA0QTU3cTdVTitmR0c0anc3aC9XWXU2VmxKSElIcDdXZms3Tmc1aVlzVU1RMlhnN0h6eW5QcGdvN0g2Wgp5d0lQQldGZzBITFRZeUNQK0NmTXBTWFMwU0wwNmlKU2VkbzU5RzR3bTVxUHlacmF2Vm1xQ0ZNPQotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQo=
  tls.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURVakNDQWpxZ0F3SUJBZ0lSQVB3UlBhWjI5aGlMdkZkQjJXTjB4ZDB3RFFZSktvWklodmNOQVFFTEJRQXcKTXpFeE1DOEdBMVVFQXhNb0wwTk9QVUZrYldsemMybHZiaUJEYjI1MGNtOXNiR1Z5SUZkbFltaHZiMnNnUkdWdApieUJEUVRBZUZ3MHlNakV4TVRjeE1UQTVNREJhRncweU56RXhNVGd4TVRBNU1EQmFNRE14TVRBdkJnTlZCQU1UCktDOURUajFCWkcxcGMzTnBiMjRnUTI5dWRISnZiR3hsY2lCWFpXSm9iMjlySUVSbGJXOGdRMEV3Z2dFaU1BMEcKQ1NxR1NJYjNEUUVCQVFVQUE0SUJEd0F3Z2dFS0FvSUJBUURaZ2RTc0tUTnZGbXdwR3FuWlkyQTVlMW5sdGE2Ngo1OCtBUkUyT2lVcjJCNDJkZ0ZuM2ptZnlnQy9rUkNsTWM0bUc0cHNJblNReStTM3ZnQjVGa3laVXM2VzZRUmVoClJXR1R2VjNXemFXM0hnL1c5OHEzK1ZGbklidnB6d1o2MDl2NVhOOVVxTW81V2kzY2xPZGp4QUNSbW9XMmFEUEIKSk8zS3paYitkVWFmZUNWZFFFaG1POUI5b2t6SGtpbWNxNFh5cWRuUUZHazNLLytsMTc1VUhHYm9WQWFXUFUwVQp6YVhrQzkwOHBmNlhNaDZmdE5mZGJvOVVYbnRSanF0RmhVYXhyWCsyS0duZGkwVk1lMWlla1k2cEJUUXdhaUNECjlkY2FRdDQwdGplK1A4UUZZcUJkdG5NdTBuQklSa3FvU3NCM1lQR1N4Q3lJYWdIUjZtKzRqbmVWQWdNQkFBR2oKWVRCZk1BNEdBMVVkRHdFQi93UUVBd0lDcERBZEJnTlZIU1VFRmpBVUJnZ3JCZ0VGQlFjREFRWUlLd1lCQlFVSApBd0l3RHdZRFZSMFRBUUgvQkFVd0F3RUIvekFkQmdOVkhRNEVGZ1FVMWJRUDJaeEppdzVEODNvL2lHYzVmNFA4Cjl6UXdEUVlKS29aSWh2Y05BUUVMQlFBRGdnRUJBRG9ta1VGNjdHN0pocS85ejBWV1BYYTBQb09MTjgzTk9JU3oKVE80Zzh6d01wKzdzOWNWUW5nd1JTSnhSbXJVT1N1TWpGMGhhTGd1Q0J0amFseE15N2Z0ajdmczBLTjJRNHNxQwoySkpxOTY5cXhnazluZVQ4MFlYSUI4WUgrRngwUXBHbmxsK1JmWmxLb0ZFUVdTai9aSmRhOWVVYmI4ZDhXV0JCCjBBRXlzNlRFQlRiT0x1S1F4Sjg5T3E1MDBpSzBBY2NwWVlPRTVud0dvTDc0RUtQaGEyaERZWHdhUnJMZ2s1V3kKcDN4ZUZjbFNCSXZ6WXFUQzZJa0dUVVZYNDVvQXcxL1J6WjNvMnhJOXhNb0ozMzhqdWF6ZlR6OWlBcWRhUEk3NQp4MUU3aFlmR2RwOFgzVEFOMXVMdTF5aWpESHBlcEVoNnplMVF5Qk8xb0lzcjBZSWpneUE9Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
---
apiVersion: v1
kind: Secret
metadata:
  name: webhook-server-tls
  labels: 
    app.kubernetes.io/name: datree-admission-webhook
    app.kubernetes.io/managed-by: "Helm"
    app.kubernetes.io/instance: "datree-webhook"
    app.kubernetes.io/version: 0.1.30
    app.kubernetes.io/part-of: "datree"
    meta.helm.sh/release-name: "datree-admission-webhook"
    meta.helm.sh/release-namespace: "datree" 
    helm.sh/chart: datree-admission-webhook-0.3.10
  namespace: datree
  annotations:
    self-signed-cert: "true"
type: kubernetes.io/tls
data:
  tls.key: LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFcGdJQkFBS0NBUUVBNlhrdEhZbWVCWWhMS1hJOHlvNkhpbE12WU9oNGVqd1A2OUNueEhOSSt6MDlPSGYwCjNiaGZWbjAwM3R2ZXRRTzZVRnF3dnBVcVZTMFBISUptamVCWjdrK2pYL25HSjZKdG9HTWF2N2hibnRQYXJRczQKbFlNK2tFQlpTUjlqNlVBS0J2TVQ2bHhPWUJyb3hpU1djM1dKMnl4dG9vRndEN2xNWDB0YmdHU21zalJ4Z0hnRApNcG1RS2RHMDRnbFIwbWFGdFpwdU03TTRXdDJFY3JHejJuVVVNU2RqZGNQbG1IZngwQ1h1blYzbE1JZTVKSEpUClhJOWdFTGpjQXRDcTh4amtVRXdsUEVPNHBsL2NreFRlaHFLVkdZNE9zRWZQTXg3WnVXeFliNlNiYm9VTDJKVkMKZGtMb29LVHJGMnRKVlc0TDEyQWN2ak5aSy92dXgzNllzd1FDZ1FJREFRQUJBb0lCQVFDRFo3Wml4NC92SVRUYwprUFZ5TkNKSlVtUjZNSjJPZnJ1ZlNBTUU2TFlNNGZ6UkNZTUNQOEU1RnFOcFEycm5pcitVZGxiQURZaVVCQlpiClAzR2xMTDZ4Q0pXMWNRbDhTVWxXV2pFMTh2ZHVQMkwydmpnTXZwKzU1TjNiOEJUMXRSdHZxZVJ0cGFKZktRWVcKYjRWV1dyTktib2tPUzdmY3diZ2djbk4vb2liSWFQU3ZVdlF0WmNKaXl2b21vemVQWEI0bGZkQTdCSVB6OUJDKwpMSEN5aWVNdjhIeUgyNmRUc0ZLTG9iTjVMaTJmb0NORG5Bb2R1emdqRTF3UitVckNHN2hlV0lXeUVlcGVJbTA2CkdEaTU1WFdlNDF1dGY3Z2V0N1kwblpVNzlFR0ZldE1VU3k0MFNZdDAyamhEVllPQXhLWWg0eFBvTzFwTGVFWTQKcC9LM2tMb0JBb0dCQU8rY1o2S3ZJSnBsbzQ4eFhUSFg0Z3ordEpTN2JTV0pRMlhHakNCZjg2dTZqZjhqaFpNOApRV21sNzVlM1FUQTdxTTFoandOdnM3UllqbUI5YW1wQmc1b0hWSnIzcXNlaTJzbmwySXU1UlNDcjZsOUdELzFTCnVVQ0hKa292cW9MWUF5ZXZMR2FmUWluT0pPQUlCdVN1Mk5hR2xQbzVaNDB2QzBoMEIvUzVkYU54QW9HQkFQbHgKVFRnYXpKNjBEakFCanh6eTEvNmNCbmlKS1VkRk14ZlhicU0yWEk2VW81clFhcmV4ZE14MU1ZNk4wZTBzb1g0NwpMcDNNQ1BwZFozZEhPNDBHL0xtaWdTcUFaZFI5SDA0R3pCQzNRSURTUFQ0UFdJMk5uVFlyZk0xRG5nQjZxUllSCmt5WkZkMjBsWWkyanlvLy9kWlQ5cXdROGJZQ1JxckdRRjc1QkVxZ1JBb0dCQUowLzVmdXNOeGRjME1SdXZ4eXcKODFkWDZTY2JBZng2WXRMdVJKUVNwSlgxTHE5Y25wTU1IbG01WHM0UXBDV0ZZYmkzNStWM2IxWlNMODQvUUpGUApRWkRhY3JucEJCbFVWWVhlNUFoK3BGRld3YytZNlhGMDBzTDRiemFNcGJpTkR6VUNEMytoMFFnaWs2eTdWOXJJCnJPSE5IUVJDbkNUWjFPdk55bExmUzhiaEFvR0JBTVVzUm5tKzFWZnR3L2syZ2tYRHYvREdyR2JESlJudEhVSVAKVEtrKzQxTGhNNkhBZFZyV3J4aWUycGx3aVN3TlIycGNwYkNlQThyRDRuRnFvU3dOQmVCSEVBcmtpNW0zZmZOVApkQ01TZDY1Y2dZUjQ1T3Fmc2xHTGRvOWFqNTZaVnViVzVaWXUrd1FQdE5lV3pSdWVOdmVhdklBUXRBNFpGdkJjCmtpZ1ZrQVhCQW9HQkFLUzRwRnlpQXk5S2thR3RlaU8yMTZ4cERpZVk5MFF3YmxQRjZBb2tRME8xeDMxZnZlSTcKUWxZdEtLZFVKalE4bTRVRXBycW84QzRmbzNuQkZaVTVnWmp1WExET1NHZGMxeHJ1alFOWFQ5WEpFTVB5SFU3YQpzZHZXTWQweVdLQlFjejFqMDBLemJGVHFBTHhMUE94UDdqdTIzWHAxYkRsN2NnRkVSakJuOW9hcQotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQo=
  tls.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURmRENDQW1TZ0F3SUJBZ0lSQU9Wb28wL2w4NjVwcU90M3dJR1VaeUl3RFFZSktvWklodmNOQVFFTEJRQXcKTXpFeE1DOEdBMVVFQXhNb0wwTk9QVUZrYldsemMybHZiaUJEYjI1MGNtOXNiR1Z5SUZkbFltaHZiMnNnUkdWdApieUJEUVRBZUZ3MHlNakV4TVRjeE1UQTVNREJhRncweU56RXhNVGd4TVRBNU1EQmFNQzh4TFRBckJnTlZCQU1UCkpDOURUajFrWVhSeVpXVXRkMlZpYUc5dmF5MXpaWEoyWlhJdVpHRjBjbVZsTG5OMll6Q0NBU0l3RFFZSktvWkkKaHZjTkFRRUJCUUFEZ2dFUEFEQ0NBUW9DZ2dFQkFPbDVMUjJKbmdXSVN5bHlQTXFPaDRwVEwyRG9lSG84RCt2UQpwOFJ6U1BzOVBUaDM5TjI0WDFaOU5ON2IzclVEdWxCYXNMNlZLbFV0RHh5Q1pvM2dXZTVQbzEvNXhpZWliYUJqCkdyKzRXNTdUMnEwTE9KV0RQcEJBV1VrZlkrbEFDZ2J6RStwY1RtQWE2TVlrbG5OMWlkc3NiYUtCY0ErNVRGOUwKVzRCa3BySTBjWUI0QXpLWmtDblJ0T0lKVWRKbWhiV2Fiak96T0ZyZGhIS3hzOXAxRkRFblkzWEQ1WmgzOGRBbAo3cDFkNVRDSHVTUnlVMXlQWUJDNDNBTFFxdk1ZNUZCTUpUeER1S1pmM0pNVTNvYWlsUm1PRHJCSHp6TWUyYmxzCldHK2ttMjZGQzlpVlFuWkM2S0NrNnhkclNWVnVDOWRnSEw0eldTdjc3c2QrbUxNRUFvRUNBd0VBQWFPQmpqQ0IKaXpBT0JnTlZIUThCQWY4RUJBTUNCYUF3SFFZRFZSMGxCQll3RkFZSUt3WUJCUVVIQXdFR0NDc0dBUVVGQndNQwpNQXdHQTFVZEV3RUIvd1FDTUFBd0h3WURWUjBqQkJnd0ZvQVUxYlFQMlp4Sml3NUQ4M28vaUdjNWY0UDg5elF3Ckt3WURWUjBSQkNRd0lvSWdaR0YwY21WbExYZGxZbWh2YjJzdGMyVnlkbVZ5TG1SaGRISmxaUzV6ZG1Nd0RRWUoKS29aSWh2Y05BUUVMQlFBRGdnRUJBTWpQaFg1RHZZVnk4NStIMFYzdTRPblNISXdTazcvZWd3VzJPRnpLR1pVdApVblQvNnMzcmpNbm5pV2VLTjU0NGlCSzJ0OW9uRVJtT3NId0xWOUpxeXoxKzhoa1FIZ3VHWVhlM21oU1RMOGFsCk50ZitSTlZwaEp3SDRTOWV2aXBId0MxTzFWNDlNRGlsbFNrQjg5dC84YzJMamdFc2hXWkdDZlhhSEUrMlA0b0UKcjhZNG5paXZuU200cGo4YjRTRW9lczVzN2VyL20vdnpOaXhlMkZlSHNpMWFvVlBwdExESXFWcU5NL1ZCNjlmYQo5d2hHVTNSQndGcjVDbzI1enRtMlh0RFZIY0NLSmR0SDh4VUtWTldRWEhQbytlV0Y1cEp0WWJwaVdnMFNIRUVYCnZ1UE1ZTHJXYlRGQVU1RzBuRzBLenkvK1pRMWZCRUhwUDFNM012dnEyeGc9Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
---
apiVersion: admissionregistration.k8s.io/v1
kind: ValidatingWebhookConfiguration
metadata:
  name: datree-webhook
  annotations:
    "helm.sh/hook": post-install, post-upgrade
    "helm.sh/hook-weight": "-5"
webhooks:
  - name: webhook-server.datree.svc
    sideEffects: None
    timeoutSeconds: 30
    admissionReviewVersions:
      - v1
      - v1beta1
    clientConfig:
      service:
        name: datree-webhook-server
        namespace: datree
        path: "/validate"
      caBundle: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURVakNDQWpxZ0F3SUJBZ0lSQVB3UlBhWjI5aGlMdkZkQjJXTjB4ZDB3RFFZSktvWklodmNOQVFFTEJRQXcKTXpFeE1DOEdBMVVFQXhNb0wwTk9QVUZrYldsemMybHZiaUJEYjI1MGNtOXNiR1Z5SUZkbFltaHZiMnNnUkdWdApieUJEUVRBZUZ3MHlNakV4TVRjeE1UQTVNREJhRncweU56RXhNVGd4TVRBNU1EQmFNRE14TVRBdkJnTlZCQU1UCktDOURUajFCWkcxcGMzTnBiMjRnUTI5dWRISnZiR3hsY2lCWFpXSm9iMjlySUVSbGJXOGdRMEV3Z2dFaU1BMEcKQ1NxR1NJYjNEUUVCQVFVQUE0SUJEd0F3Z2dFS0FvSUJBUURaZ2RTc0tUTnZGbXdwR3FuWlkyQTVlMW5sdGE2Ngo1OCtBUkUyT2lVcjJCNDJkZ0ZuM2ptZnlnQy9rUkNsTWM0bUc0cHNJblNReStTM3ZnQjVGa3laVXM2VzZRUmVoClJXR1R2VjNXemFXM0hnL1c5OHEzK1ZGbklidnB6d1o2MDl2NVhOOVVxTW81V2kzY2xPZGp4QUNSbW9XMmFEUEIKSk8zS3paYitkVWFmZUNWZFFFaG1POUI5b2t6SGtpbWNxNFh5cWRuUUZHazNLLytsMTc1VUhHYm9WQWFXUFUwVQp6YVhrQzkwOHBmNlhNaDZmdE5mZGJvOVVYbnRSanF0RmhVYXhyWCsyS0duZGkwVk1lMWlla1k2cEJUUXdhaUNECjlkY2FRdDQwdGplK1A4UUZZcUJkdG5NdTBuQklSa3FvU3NCM1lQR1N4Q3lJYWdIUjZtKzRqbmVWQWdNQkFBR2oKWVRCZk1BNEdBMVVkRHdFQi93UUVBd0lDcERBZEJnTlZIU1VFRmpBVUJnZ3JCZ0VGQlFjREFRWUlLd1lCQlFVSApBd0l3RHdZRFZSMFRBUUgvQkFVd0F3RUIvekFkQmdOVkhRNEVGZ1FVMWJRUDJaeEppdzVEODNvL2lHYzVmNFA4Cjl6UXdEUVlKS29aSWh2Y05BUUVMQlFBRGdnRUJBRG9ta1VGNjdHN0pocS85ejBWV1BYYTBQb09MTjgzTk9JU3oKVE80Zzh6d01wKzdzOWNWUW5nd1JTSnhSbXJVT1N1TWpGMGhhTGd1Q0J0amFseE15N2Z0ajdmczBLTjJRNHNxQwoySkpxOTY5cXhnazluZVQ4MFlYSUI4WUgrRngwUXBHbmxsK1JmWmxLb0ZFUVdTai9aSmRhOWVVYmI4ZDhXV0JCCjBBRXlzNlRFQlRiT0x1S1F4Sjg5T3E1MDBpSzBBY2NwWVlPRTVud0dvTDc0RUtQaGEyaERZWHdhUnJMZ2s1V3kKcDN4ZUZjbFNCSXZ6WXFUQzZJa0dUVVZYNDVvQXcxL1J6WjNvMnhJOXhNb0ozMzhqdWF6ZlR6OWlBcWRhUEk3NQp4MUU3aFlmR2RwOFgzVEFOMXVMdTF5aWpESHBlcEVoNnplMVF5Qk8xb0lzcjBZSWpneUE9Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
    namespaceSelector:
      matchExpressions:
        - key: admission.datree/validate
          operator: DoesNotExist
    rules:
      - operations: ["CREATE", "UPDATE"]
        apiGroups: ["*"]
        apiVersions: ["*"]
        resources: ["*"]

---
# Source: datree-admission-webhook/templates/serviceaccount.yaml

apiVersion: v1
kind: ServiceAccount
metadata:
  name: datree-webhook-server
  namespace: datree
  labels: 
    app.kubernetes.io/name: datree-admission-webhook
    app.kubernetes.io/managed-by: "Helm"
    app.kubernetes.io/instance: "datree-webhook"
    app.kubernetes.io/version: 0.1.30
    app.kubernetes.io/part-of: "datree"
    meta.helm.sh/release-name: "datree-admission-webhook"
    meta.helm.sh/release-namespace: "datree" 
    helm.sh/chart: datree-admission-webhook-0.3.10
---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: datree-label-namespaces-hook-post-install
  labels: 
    app.kubernetes.io/name: datree-admission-webhook
    app.kubernetes.io/managed-by: "Helm"
    app.kubernetes.io/instance: "datree-webhook"
    app.kubernetes.io/version: 0.1.30
    app.kubernetes.io/part-of: "datree"
    meta.helm.sh/release-name: "datree-admission-webhook"
    meta.helm.sh/release-namespace: "datree" 
    helm.sh/chart: datree-admission-webhook-0.3.10
---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: datree-cleanup-namespaces-hook-pre-delete
  labels: 
    app.kubernetes.io/name: datree-admission-webhook
    app.kubernetes.io/managed-by: "Helm"
    app.kubernetes.io/instance: "datree-webhook"
    app.kubernetes.io/version: 0.1.30
    app.kubernetes.io/part-of: "datree"
    meta.helm.sh/release-name: "datree-admission-webhook"
    meta.helm.sh/release-namespace: "datree" 
    helm.sh/chart: datree-admission-webhook-0.3.10
---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: datree-wait-server-ready-hook-post-install
  labels: 
    app.kubernetes.io/name: datree-admission-webhook
    app.kubernetes.io/managed-by: "Helm"
    app.kubernetes.io/instance: "datree-webhook"
    app.kubernetes.io/version: 0.1.30
    app.kubernetes.io/part-of: "datree"
    meta.helm.sh/release-name: "datree-admission-webhook"
    meta.helm.sh/release-namespace: "datree" 
    helm.sh/chart: datree-admission-webhook-0.3.10
---
# Source: datree-admission-webhook/templates/role.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: datree-pods-reader
  labels: 
    app.kubernetes.io/name: datree-admission-webhook
    app.kubernetes.io/managed-by: "Helm"
    app.kubernetes.io/instance: "datree-webhook"
    app.kubernetes.io/version: 0.1.30
    app.kubernetes.io/part-of: "datree"
    meta.helm.sh/release-name: "datree-admission-webhook"
    meta.helm.sh/release-namespace: "datree" 
    helm.sh/chart: datree-admission-webhook-0.3.10
rules:
  - apiGroups:
      - ""
    resources:
      - "pods"
      - "jobs"
    verbs:
      - "get"
      - "list"
      - "watch"
---
# Source: datree-admission-webhook/templates/namespace-post-install.yaml
apiVersion: batch/v1
kind: Job
metadata:
  name: datree-label-namespaces-hook-post-install
  namespace: datree
  labels: 
    app.kubernetes.io/name: datree-admission-webhook
    app.kubernetes.io/managed-by: "Helm"
    app.kubernetes.io/instance: "datree-webhook"
    app.kubernetes.io/version: 0.1.30
    app.kubernetes.io/part-of: "datree"
    meta.helm.sh/release-name: "datree-admission-webhook"
    meta.helm.sh/release-namespace: "datree" 
    helm.sh/chart: datree-admission-webhook-0.3.10
  annotations:
    "helm.sh/hook": post-install, post-upgrade
    "helm.sh/hook-weight": "-5"
    "helm.sh/hook-delete-policy": hook-succeeded, hook-failed
spec:
  template:
    metadata:
      labels: 
        app.kubernetes.io/name: datree-admission-webhook
        app.kubernetes.io/managed-by: "Helm"
        app.kubernetes.io/instance: "datree-webhook"
        app.kubernetes.io/version: 0.1.30
        app.kubernetes.io/part-of: "datree"
        meta.helm.sh/release-name: "datree-admission-webhook"
        meta.helm.sh/release-namespace: "datree" 
        helm.sh/chart: datree-admission-webhook-0.3.10
    spec:
      serviceAccount: datree-label-namespaces-hook-post-install
      restartPolicy: OnFailure
      nodeSelector:
        kubernetes.io/os: linux
      containers:
        - name: kubectl-label
          image: "bitnami/kubectl@sha256:d3c17f1dc6e665dcc78e8c14a83ae630bc3d65b07ea11c5f1a012c2c6786d039"
          imagePullPolicy: IfNotPresent
          args:
            - label
            - ns
            - kube-system
            - datree
            - admission.datree/validate=skip
            - --overwrite

---
# Source: datree-admission-webhook/templates/clusterrolebinding.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: datree-webhook-server-read 
  labels: 
    app.kubernetes.io/name: datree-admission-webhook
    app.kubernetes.io/managed-by: "Helm"
    app.kubernetes.io/instance: "datree-webhook"
    app.kubernetes.io/version: 0.1.30
    app.kubernetes.io/part-of: "datree"
    meta.helm.sh/release-name: "datree-admission-webhook"
    meta.helm.sh/release-namespace: "datree" 
    helm.sh/chart: datree-admission-webhook-0.3.10
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: datree-webhook-server-read # datree-webhook-server-read
subjects:
  - kind: ServiceAccount
    name: datree-webhook-server # datree-webhook-server
    namespace: datree
---apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: datree-namespaces-update
  labels: 
    app.kubernetes.io/name: datree-admission-webhook
    app.kubernetes.io/managed-by: "Helm"
    app.kubernetes.io/instance: "datree-webhook"
    app.kubernetes.io/version: 0.1.30
    app.kubernetes.io/part-of: "datree"
    meta.helm.sh/release-name: "datree-admission-webhook"
    meta.helm.sh/release-namespace: "datree" 
    helm.sh/chart: datree-admission-webhook-0.3.10
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: datree-namespaces-update
subjects:
  - kind: ServiceAccount
    name: "datree-label-namespaces-hook-post-install"
    namespace: "datree"
  - kind: ServiceAccount
    name: "datree-cleanup-namespaces-hook-pre-delete"
    namespace: "datree"
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: datree-validationwebhook-delete
  labels: 
    app.kubernetes.io/name: datree-admission-webhook
    app.kubernetes.io/managed-by: "Helm"
    app.kubernetes.io/instance: "datree-webhook"
    app.kubernetes.io/version: 0.1.30
    app.kubernetes.io/part-of: "datree"
    meta.helm.sh/release-name: "datree-admission-webhook"
    meta.helm.sh/release-namespace: "datree" 
    helm.sh/chart: datree-admission-webhook-0.3.10
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: datree-validationwebhook-delete
subjects:
  - kind: ServiceAccount
    name: "datree-cleanup-namespaces-hook-pre-delete"
    namespace: "datree"

---
# Source: datree-admission-webhook/templates/cluster-scan-cronjob.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: cluster-scan-job-service-account
  namespace: datree
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: cluster-scan-job-role
rules:
  - apiGroups:
      - "*"
    resources:
      - "*"
    verbs:
      - "get"
      - "list"
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: cluster-scan-job-rolebinding
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: cluster-scan-job-role
subjects:
  - kind: ServiceAccount
    name: cluster-scan-job-service-account
    namespace: datree
---
apiVersion: {- .Chart.datree.CronJob.apiVersion -}
kind: CronJob
metadata:
  name: scan-cronjob
  namespace: datree
  annotations:
    "helm.sh/hook": post-install
spec:
  schedule: "0 0 * * *"
  jobTemplate:
    spec:
      backoffLimit: 4
      template:
        spec:
          serviceAccountName: cluster-scan-job-service-account
          restartPolicy: Never
          containers:
            - name: scan-job
              env:
                - name: DATREE_TOKEN
                  value: 41768880-c714-43be-a6ec-95511931bb5e
              securityContext:
                allowPrivilegeEscalation: false
                readOnlyRootFilesystem: true
                runAsNonRoot: true
                runAsUser: 25000
                seccompProfile:
                  type: RuntimeDefault
              image: "datree/scan-job:0.0.8"
              imagePullPolicy: Always
              resources:
                limits:
                  cpu: 1000m
                  memory: 512Mi
                requests:
                  cpu: 1000m
                  memory: 256Mi
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: datree-scanner
  namespace: datree
  labels: 
    app.kubernetes.io/name: datree-admission-webhook
    app.kubernetes.io/managed-by: "Helm"
    app.kubernetes.io/instance: "datree-webhook"
    app.kubernetes.io/version: 0.1.30
    app.kubernetes.io/part-of: "datree"
    meta.helm.sh/release-name: "datree-admission-webhook"
    meta.helm.sh/release-namespace: "datree" 
    helm.sh/chart: datree-admission-webhook-0.3.10
    owner: datree
    app: "datree-scanner"
spec:
  replicas: 1
  selector:
    matchLabels:
      app: "datree-scanner"
  template:
    metadata:
      labels: 
        app.kubernetes.io/name: datree-admission-webhook
        app.kubernetes.io/managed-by: "Helm"
        app.kubernetes.io/instance: "datree-webhook"
        app.kubernetes.io/version: 0.1.30
        app.kubernetes.io/part-of: "datree"
        meta.helm.sh/release-name: "datree-admission-webhook"
        meta.helm.sh/release-namespace: "datree" 
        helm.sh/chart: datree-admission-webhook-0.3.10
        app: "datree-scanner"
    spec:
      serviceAccountName: cluster-scan-job-service-account
      containers:
        - name: datree-scanner
          env:
            - name: DATREE_TOKEN
              value: 41768880-c714-43be-a6ec-95511931bb5e
          securityContext:
            allowPrivilegeEscalation: false
            readOnlyRootFilesystem: true
            runAsNonRoot: true
            runAsUser: 25000
          livenessProbe:
            httpGet:
              path: /health
              port: 8444
              scheme: HTTP
            initialDelaySeconds: 5
            periodSeconds: 10
          readinessProbe:
            httpGet:
              path: /ready
              port: 8444
              scheme: HTTP
            initialDelaySeconds: 5
            periodSeconds: 10
          resources:
            limits:
              memory: 512Mi
            requests:
              cpu: 1000m
              memory: 512Mi
          image: "datree/scan-job:0.0.8"
          imagePullPolicy: Always
          ports:
            - containerPort: 8444
              name: datree-scanner

---
# Source: datree-admission-webhook/templates/wait-server-ready-post-install.yaml
apiVersion: batch/v1
kind: Job
metadata:
  name: datree-wait-server-ready-hook-post-install
  namespace: datree
  labels: 
    app.kubernetes.io/name: datree-admission-webhook
    app.kubernetes.io/managed-by: "Helm"
    app.kubernetes.io/instance: "datree-webhook"
    app.kubernetes.io/version: 0.1.30
    app.kubernetes.io/part-of: "datree"
    meta.helm.sh/release-name: "datree-admission-webhook"
    meta.helm.sh/release-namespace: "datree" 
    helm.sh/chart: datree-admission-webhook-0.3.10
  annotations:
    "helm.sh/hook": post-install, post-upgrade
    "helm.sh/hook-weight": "-5"
    "helm.sh/hook-delete-policy": hook-succeeded, hook-failed
spec:
  template:
    metadata:
      name: datree-wait-server-ready-hook-post-install
      labels: 
        app.kubernetes.io/name: datree-admission-webhook
        app.kubernetes.io/managed-by: "Helm"
        app.kubernetes.io/instance: "datree-webhook"
        app.kubernetes.io/version: 0.1.30
        app.kubernetes.io/part-of: "datree"
        meta.helm.sh/release-name: "datree-admission-webhook"
        meta.helm.sh/release-namespace: "datree" 
        helm.sh/chart: datree-admission-webhook-0.3.10
    spec:
      serviceAccountName: datree-wait-server-ready-hook-post-install
      restartPolicy: Never
      containers:
      - name: kubectl-client
        image: "bitnami/kubectl@sha256:d3c17f1dc6e665dcc78e8c14a83ae630bc3d65b07ea11c5f1a012c2c6786d039"
        imagePullPolicy: IfNotPresent
        command:
          - sh
          - "-c"
          - >-
            kubectl wait --for=condition=ready pod -l app=datree-webhook-server --timeout="180s"

---
# Source: datree-admission-webhook/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: datree-webhook-server
  namespace: datree
  labels: 
    app.kubernetes.io/name: datree-admission-webhook
    app.kubernetes.io/managed-by: "Helm"
    app.kubernetes.io/instance: "datree-webhook"
    app.kubernetes.io/version: 0.1.30
    app.kubernetes.io/part-of: "datree"
    meta.helm.sh/release-name: "datree-admission-webhook"
    meta.helm.sh/release-namespace: "datree" 
    helm.sh/chart: datree-admission-webhook-0.3.10
spec:
  selector:
    app: "datree-webhook-server"
  ports:
    - port: 443
      targetPort: webhook-api

---
# Source: datree-admission-webhook/templates/rolebinding.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: datree-pods-reader
  labels: 
    app.kubernetes.io/name: datree-admission-webhook
    app.kubernetes.io/managed-by: "Helm"
    app.kubernetes.io/instance: "datree-webhook"
    app.kubernetes.io/version: 0.1.30
    app.kubernetes.io/part-of: "datree"
    meta.helm.sh/release-name: "datree-admission-webhook"
    meta.helm.sh/release-namespace: "datree" 
    helm.sh/chart: datree-admission-webhook-0.3.10
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: datree-pods-reader
subjects:
  - kind: ServiceAccount
    name: datree-wait-server-ready-hook-post-install
    namespace: "datree"
---
# Source: datree-admission-webhook/templates/namespace-post-delete.yaml
apiVersion: batch/v1
kind: Job
metadata:
  name: datree-cleanup-namespaces-hook-pre-delete
  labels: 
    app.kubernetes.io/name: datree-admission-webhook
    app.kubernetes.io/managed-by: "Helm"
    app.kubernetes.io/instance: "datree-webhook"
    app.kubernetes.io/version: 0.1.30
    app.kubernetes.io/part-of: "datree"
    meta.helm.sh/release-name: "datree-admission-webhook"
    meta.helm.sh/release-namespace: "datree" 
    helm.sh/chart: datree-admission-webhook-0.3.10
  namespace: datree
  annotations: 
    "helm.sh/hook": pre-delete, pre-upgrade
    "helm.sh/hook-delete-policy": hook-succeeded, hook-failed
spec:
  template:
    metadata:
      labels: 
        app.kubernetes.io/name: datree-admission-webhook
        app.kubernetes.io/managed-by: "Helm"
        app.kubernetes.io/instance: "datree-webhook"
        app.kubernetes.io/version: 0.1.30
        app.kubernetes.io/part-of: "datree"
        meta.helm.sh/release-name: "datree-admission-webhook"
        meta.helm.sh/release-namespace: "datree" 
        helm.sh/chart: datree-admission-webhook-0.3.10
    spec:
      restartPolicy: OnFailure
      serviceAccount: datree-cleanup-namespaces-hook-pre-delete
      nodeSelector:
        kubernetes.io/os: linux
      containers:
        - name: kubectl-label
          image: "bitnami/kubectl@sha256:d3c17f1dc6e665dcc78e8c14a83ae630bc3d65b07ea11c5f1a012c2c6786d039"
          imagePullPolicy: IfNotPresent
          command:
            - sh
            - "-c"
            - >-
              kubectl delete validatingwebhookconfigurations.admissionregistration.k8s.io datree-webhook -n datree;
              kubectl label ns kube-system datree datree.io/skip-;

---
# Source: datree-admission-webhook/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: datree-webhook-server
  namespace: datree
  labels: 
    app.kubernetes.io/name: datree-admission-webhook
    app.kubernetes.io/managed-by: "Helm"
    app.kubernetes.io/instance: "datree-webhook"
    app.kubernetes.io/version: 0.1.30
    app.kubernetes.io/part-of: "datree"
    meta.helm.sh/release-name: "datree-admission-webhook"
    meta.helm.sh/release-namespace: "datree" 
    helm.sh/chart: datree-admission-webhook-0.3.10
    owner: datree
    app: "datree-webhook-server"
spec:
  replicas: 2
  selector:
    matchLabels: 
      app: "datree-webhook-server"
  template:
    metadata:
      labels: 
        app.kubernetes.io/name: datree-admission-webhook
        app.kubernetes.io/managed-by: "Helm"
        app.kubernetes.io/instance: "datree-webhook"
        app.kubernetes.io/version: 0.1.30
        app.kubernetes.io/part-of: "datree"
        meta.helm.sh/release-name: "datree-admission-webhook"
        meta.helm.sh/release-namespace: "datree" 
        helm.sh/chart: datree-admission-webhook-0.3.10
        app: "datree-webhook-server"
    spec:
      serviceAccountName: datree-webhook-server
      containers:
        - name: server
          # caution: don't change the order of the environment variables
          # changing the order will harm resource patching
          env:
            - name: DATREE_TOKEN
              value: 41768880-c714-43be-a6ec-95511931bb5e
            - name: DATREE_POLICY
              value: 
            - name: DATREE_VERBOSE
              value: 
            - name: DATREE_OUTPUT
              value: 
            - name: DATREE_NO_RECORD
              value: 
            - name: DATREE_ENFORCE
              value: 
          securityContext:
            allowPrivilegeEscalation: false
            readOnlyRootFilesystem: true
            runAsNonRoot: true
            runAsUser: 25000
          livenessProbe:
            httpGet:
              path: /health
              port: 8443
              scheme: HTTPS
            initialDelaySeconds: 5
            periodSeconds: 10
          readinessProbe:
            httpGet:
              path: /ready
              port: 8443
              scheme: HTTPS
            initialDelaySeconds: 5
            periodSeconds: 10
          resources:
            limits:
              memory: 512Mi
            requests:
              cpu: 1000m
              memory: 512Mi
          image: "datree/admission-webhook:0.1.30"
          imagePullPolicy: Always
          ports:
            - containerPort: 8443
              name: webhook-api
          volumeMounts:
            - name: webhook-tls-certs
              mountPath: /run/secrets/tls
              readOnly: true
            - name: webhook-config
              mountPath: /config
              readOnly: true
      volumes:
        - name: webhook-tls-certs
          secret:
            secretName: webhook-server-tls
        - name: webhook-config
          configMap:
            name: webhook-scanning-filters
            optional: true
